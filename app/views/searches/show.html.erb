<h1>Поиск билета</h1>

<p>
  <%= form_tag search_path, method: :post do %>
  <div f.field >
    
    <%= label_tag :base_station, 'Выбрать станцию отправления' %>
    <%= select_tag :base_station_id, options_from_collection_for_select(RailwayStation.all, :id, :title, {})  %>  
    <%= label_tag :end_station, 'Выбрать станцию назначения' %>
    <%= select_tag :end_station_id, options_from_collection_for_select(RailwayStation.all, :id, :title, {})  %> 
 </div>

  <div f.actions >  
    <%= submit_tag "Найти" %>  
 </div>
  <% end %>
   Маршрут -   
  <%= @base_station.title %>
-
  <%= @end_station.title %>
<p>
  <% if @route.nil? || @route.empty? %>
      Маршрут не найден
</p>
      <% else %>
     Поезда на маршруте:
          <% @trains = [] %>
          <% if @route.class == Route %>
            <% @trains << @route.trains %>
            <% else %>
              <% @route.each do |route| %>
                 <% @trains << route.trains %>
              <% end %>
              <% @trains.flatten! %>
          <% end %>
       <% if @trains.empty? %>
          На маршруте нет поездов
<p>
          <% else %>
        
<table>
      <thead>
       <tr>
        <td>Номер поезда</td>
        <td>Время отправления</td>
        <td>Время прибытия</td>
        <td>  </td>
       </tr>
      </thead>
    <tbody>
     <% @trains.each do |train| %>
      <tr>
       <td><%= train.number %></td>
       <td><%= @base_station.departure_time_in(train.route) %></td>
       <td><%= @end_station.arrival_time_in(train.route) %></td>
  
       </tr>
      <% end %>
 </tbody>
</table>

    <% end %>   
  <% end %>
